define("wkview:widget/ui/html_view/slider/control.js",function(t,o,e){var n=t("wkview:widget/ui/html_view/widget.js").widget,s=t("wkview:widget/ui/html_view/dep/object/object.js"),i=t("wkview:widget/ui/html_view/dep/page/page.js"),r=t("wkview:widget/ui/html_view/dep/drag/drag.js").drag,a=n({Options:{accuracy:0,orientation:"vertical",direction:"backward"},elements:{"@view":"$view","@start-corner":"$startCorner","@last-corner":"$lastCorner","@inner":"$inner","@process":"$process","@knob":"$knob","@thumbs":"$thumbs","@thumbs-content":"$thumbsContent","@arrow-left":"$arrowLeft","@arrow-right":"$arrowRight","@toolbar-ipt":"$toolbarIpt"},events:{"$view click,mousedown":"_eventControl","$knob mousedown":"thumbsShow","$arrowRight click":"next","$arrowLeft click":"prev","$toolbarIpt blur":"blur","$toolbarIpt keyup":"keyup","$toolbarIpt keydown":"keydown"},_init:function(){var t=this,o=t.options._isVertical="vertical"===t.options.orientation;t.options.freeValue=((t.options.freeNum-1)/t.options.countPn).toFixed(4),"backward"===t.options.direction&&(t.options._oppsite=!0),s.extend(t.options,{_suffix:o?"vtl":"htl",_knobKey:o?"top":"left",_mouseKey:o?"y":"x",_accuracyKey:o?"height":"width"})},next:function(){this.fire("nextbtn")},prev:function(){this.fire("prevbtn")},blur:function(){var t=this.$elements.$toolbarIpt.val();t!==this.curPn&&this.$elements.$toolbarIpt.val(this.curPn)},keyup:function(t){var o=this,e=o.$elements.$toolbarIpt.val();if(13===t.keyCode&&~~e>0&&~~e<=o.options.countPn){e=~~e>o.options.freeNum?o.options.freeNum:~~e,o.setCurPage(e),o.fire("gotopage"),o.fire("closeTrade");var n=((e-1)/o.options.countPn).toFixed(4);o.setValue(n),o.fire("onchange",{value:n})}},keydown:function(t){{var o=this;o.$elements.$toolbarIpt.val()}(t.keyCode<48||t.keyCode>57)&&13!==t.keyCode&&8!==t.keyCode&&t.preventDefault()},_initEvents:function(){var t=this;t.on("onload",function(){var o=t.$elements.$view,e=t.$elements.$inner,n=t.options._accuracyKey;t.options._val="offset"+n.replace(/([a-z])([a-z]*)/,function(t,o,e){return o.toUpperCase()+e}),t.options.width=o.width(),t.options.height=o.height(),t.options._range=[0,t.options[n]],t.options._limit=e[0][t.options._val],t.options._const=(t.options._range[1]-t.options._limit)/2,t._setAccuracy(t.options.accuracy),t.setValue(t.options.currentValue),t.setRange(t.options.freeValue)});var o=!0;t.on("change",function(){if(o)return o=!1,!1;t.thumbsShow();var e=t.$elements.$knob.css("left");t.$elements.$thumbs.css("left",e)}),t.on("onslidestop",function(){t.thumbsHide()})},setValue:function(t){var o=this;if(o.curPn>o.options.freeNum)return t=o.options.freeValue,o.fire("goToTrade"),!1;o.curPn===o.options.countPn&&(t=1);var e=o.options._accuracyKey;t=t||0;var n=o.options[e]*t;o.options._oppsite&&(n=o.options[e]*o._accSub(1,t)),o._setPosition({target:null,noAccuracy:!0,noFx:!0},n),o.options.currentValue=t},getValue:function(){return this.options.currentValue},setRange:function(t){var o=this,e=o.options[o.options._accuracyKey],n=t*e;if(!o.options.accuracy){o.options._oppsite?o.options._range[0]=n:o.options._range[1]=n,o.options._percent=n/e;var s=o.$elements.$knob;o.options.maxRange=o.options._range[1]+s[0][o.options._val]}},_accSub:function(t,o){var e,n,s,i;try{e=t.toString().split(".")[1].length}catch(r){e=0}try{n=o.toString().split(".")[1].length}catch(r){n=0}return s=Math.pow(10,Math.max(e,n)),i=e>=n?e:n,+((t*s-o*s)/s).toFixed(i)},_startDrag:function(t){var o=this,e=o.$elements.$knob,n=o.$elements.$process,s=o.options.accuracy,i=o.options.width,a=o.options.height,c=0,p=0,u=e[0][o.options._val],l=o.options._range,_=[],f=parseInt(e.css("margin-"+o.options._knobKey),10);t.stopPropagation(),o.options._isVertical?(a=l[1]+u,c=l[0]):(i=l[1]+u,p=l[0]),_=[c,i,a,p],t.target!==e[0]||o._isMoving||(o._recover(),r(e[0],{range:_,fix:[o.options._knobKey,f],ondragstart:function(){o.fire("onslidestart")},ondrag:function(){var t=o._getRealPos(e,o.options._knobKey),s=o._getProcessPos(t);n.css(o.options._accuracyKey,s),o._setCurrentValue(t),o.options.currentValue>o.options.freeValue&&(o.options.currentValue=o.options.freeValue),o.fire("onslide"),o.fire("onchange",{value:o.options.currentValue,offset:s}),o.fire("closeTrade")},ondragend:function(t,e,n){n=n[o.options._knobKey],o._reset(n),s&&o._useAdsorbr(n),o.fire("gotopage")}}))},_resize:function(){var t,o=this,e=isNaN(Math.min(o.options._percent,1))?1:Math.min(o.options._percent,1),n=o.$elements.$inner,s=o.$elements.$view;o.options.width=s.width(),o.options.height=s.height(),o.options._limit=n[0][o.options._val],t=o.options[o.options._accuracyKey],o.options._range=o.options._oppsite?1>e?[t*e,t]:[0,t]:[0,t*e],o._setAccuracy(o.options.accuracy)},_recover:function(){var t=this,o=t.$elements.$knob,e=t.$elements.$process,n=t.options._accuracyKey,s=o[0].style[t.options._knobKey],i=e[0].style[n];/px|auto/.test(s)||(s.length||(s=0),i.length||(i=0),s=parseFloat(s)/100*t.options[n]+"px",i=parseFloat(i)/100*t.options._limit+"px",o.css(t.options._knobKey,s),e.css(n,i))},_reset:function(t){var o=this,e=o.$elements.$knob,n=o.$elements.$process;/%/.test(t)||(e.css(o.options._knobKey,o._knobPercent(t)),n.css(o.options._accuracyKey,o._processPercent(o._getProcessPos(t))))},_knobPercent:function(t){return parseFloat(t)/this.options[this.options._accuracyKey]*100+"%"},_processPercent:function(t){return 0===this.options._limit?"0":parseFloat(t)/this.options._limit*100+"%"},_getRealPos:function(t,o){return t[0].style[o]},_getProcessPos:function(t){var o=this,e=o.options._range,n=o.options._limit;if(t=parseFloat(t)-o.options._const,e[0]&&t<e[0]){var s=e[0]-o.options._const;return s>0?s+"px":0}return t>e[1]?e[1]-o.options._const+"px":(0>t&&(t=0),t>n&&(t=n),o.options._oppsite&&(t=n-t),t+"px")},_getKnobPos:function(t){var o=this;t=parseFloat(t);var e=o.options._range;return t=o.options._oppsite?t<e[0]?e[0]:t:t>e[1]?e[1]:t,t+"px"},_getMousePos:function(){var t=this.$elements.$view,o=i.getMousePosition(),e=t.offset();return"x"===this.options._mouseKey?o.x-e.left:o.y-e.top},_move:function(t,o,e){var n=this,s=(n.options._range,n._getKnobPos(e)),i=n._getProcessPos(e),r=n.$elements.$knob,a=n.$elements.$process;n._setCurrentValue(s),r.css(n.options._knobKey,n._knobPercent(s)),a.css(n.options._accuracyKey,n._processPercent(i))},_setCurrentValue:function(t){var o=this,e=10*parseFloat(t)/(10*o.options[o.options._accuracyKey]);o.options._oppsite&&(e=o._accSub(1,e)),o.options.currentValue=e},_slide:function(t,o){var e=this,n=e.$elements.$knob,s=e.$elements.$process;e.fire("startFx",{knob:n,process:s,pos:t,fn:o})&&(e._move(n,s,t),o&&o())},_setPosition:function(t,o){var e=this,n=e.$elements.$knob,s=t.noAccuracy||!e.options.accuracy,i=function(){e._isMoving=!1,e.fire("onchange",{value:e.options.currentValue})};void 0===o&&(o=e._getMousePos()),t.target!==n[0]&&(e._isMoving=!0,s?e._slide(o,i,t.noFx):e._useAdsorbr(o,i,t.noFx))},_useAdsorbr:function(t,o,e){var n=this;t=parseFloat(t)||0;var s,i=n.options._range,r=n.options._accuracyZone.slice(0),a=r.length,c=0,p=t;if(0===t||t>i[1])s=t;else if(n.options.accuracy)for(;a>c;c++){var u=Math.abs(r[c]-t);p>=u&&(p=u,s=r[c])}else s=t;n._slide(s,o,e)},_setAccuracy:function(t){var o,e=this,n=e.options._range,s=e.options._accuracyKey,i=t*e.options[s],r=0,a=[0];for(0===t&&(e.options.accuracy=0,delete e.options._accuracyZone),e.options.accuracy=t;(o=r+i)&&o<n[1];)r=o,a.push(o);e.options._accuracyZone=a.concat(e.options[s])},_eventControl:function(t){var o=this,e=o.$elements.$knob;if(t.preventDefault(),o._resize(),o.getStatus())if(t.target===e[0]&&"mousedown"===t.type)o._startDrag(t);else if("mousedown"===t.type&&o.fire("onbeforeslideclick")){this.fire("closeTrade");var n=o._getMousePos();n<=o.options.maxRange?(o._setPosition(t),o.fire("gotopage"),o.fire("onslideclick")):(o.setCurPage(o.options.freeNum),o.fire("gotopage"),o.setValue(o.options.freeValue),o.fire("onchange",{value:o.options.freeValue}))}},setCurPage:function(t){this.curPn=t},getCurPage:function(){return this.curPn},setIpt:function(t){this.$elements.$toolbarIpt.val(t)},setThumbs:function(t){this.$elements.$thumbsContent.html(t)},thumbsHide:function(){this.$elements.$thumbs.hide()},thumbsShow:function(){this.$elements.$thumbs.show()},setCountPn:function(t){this.options.countPn=t}},{type:"Slider_Control"});e.exports.Control=a});